\documentclass[usepdftitle=false]{beamer}

\usepackage[frenchb]{babel}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{datetime}
\usepackage{eurosym}
\usepackage[]{url}
\usepackage[babel=true]{csquotes}
\usepackage{listings}
\usepackage{fancyvrb}
\usepackage{xcolor}
\hypersetup{
pdfauthor={Thibaud Duhautbout - Rémy Huet},
pdftitle={Formation Picaosft : La gestion de version avec Git},
pdfsubject={Formation niveau 1 : les bases},
pdfkeywords={git, gestion de version, VCS},
pdfproducer={Latex},
}

\beamertemplatenavigationsymbolsempty
\setbeamercolor{orangebox}{bg=orange,fg=black}
\setbeamercolor{terminal}{bg=darkgray,fg=white}

\newdateformat{nombres}{\THEDAY-\THEMONTH-\THEYEAR}
\def\seplength{.5\topsep}

% Dans le cas d'une compilation pour la présentation, on active les
% pauses dans les slides (inutiles pour la version support à diffuser)
\newcommand{\Pause}{%
\ifdef{\Release}
  {\pause}
  {}
}

\title[Formation Git\_v1]{\today \\ Formation Picasoft : La gestion de version avec Git (niveau 1)}
\titlegraphic{\includegraphics[scale=.1]{picasoft_logo.png}}
\author[T. Duhautbout - R. Huet]{Thibaud {\sc Duhautbout} \\ Rémy {\sc Huet}}
\institute[Picasoft]{Association Picasoft}
\date\today

\usetheme{AnnArbor}
\usecolortheme{crane}

\fvset{fontsize=\tiny,commandchars=\\\{\}}

\AtBeginSection[]
{
	\begin{frame}
		\tableofcontents[currentsection, hideothersubsections]
	\end{frame}
}

\begin{document}

\begin{frame}
	\titlepage
\end{frame}

\section{Introduction}

\begin{frame}{Pourquoi la gestion de version ?}
Pour tout le monde :
\begin{itemize}
\item sauvegarde incrémentale du travail
\item suivi des modifications et retour en arrière
\item partage des modifications avec d'autres personnes
\end{itemize}

\medskip

Pour les développeurs :
\begin{itemize}
\item centralisation des sources
\item collaboration simplifiée
\item possibilité de maintenir plusieurs versions
\item ...
\end{itemize}
\end{frame}

\begin{frame}{Les différents logiciels de version}
\includegraphics[height=2cm]{./imgs/logo_git.png}
\hfill
\includegraphics[height=2cm]{./imgs/logo_svn.png}
\hfill
\includegraphics[height=2cm]{./imgs/logo_mercurial.png}

\bigskip

\centering
Et plein d'autres !

37 systèmes recensés sur Wikipedia

(\url{https://en.wikipedia.org/wiki/Comparison_of_version_control_software})
\end{frame}

\begin{frame}{Petite histoire de git\ldots}

\begin{center}
\includegraphics[height=2cm]{./imgs/logo_git.png}
\end{center}

\begin{itemize}
\item Créé en 2005 par les développeurs du noyau Linux
\item Système de gestion de version distribué
\item Rapide
\item Possibilité de développements non-linéaires (branches)
\item Popularité grandissante chez les développeurs (GitHub, GitLab)
\end{itemize}
\end{frame}

\begin{frame}
\begin{beamercolorbox}[sep=5pt,center,rounded=true,shadow=true]{orangebox}
\Large
\textsc{On passe à la partie pratique !}
\end{beamercolorbox}
\begin{center}
\includegraphics[height=3cm]{./imgs/warning.jpg}
\end{center}

\centering
Dans la suite, on considère que git est installé pour toutes les machines !

\medskip

\centering
En cas de problème, n'hésitez pas à demander de l'aide aux gentils animateurs munis d'une pancarte \enquote{HELP} :)

\begin{block}{}
\centering
On ouvre un terminal ou Git Bash !
\end{block}
\end{frame}

\section{Concepts de base}

\subsection{Configuration et initialisation}

\begin{frame}[fragile]{Configuration de git et du repo}

Création d'un nouveau répertoire de travail
\begin{beamercolorbox}[rounded=true,shadow=true]{terminal}
\vspace{-\seplength}
\begin{Verbatim}
$ mkdir formation_git
$ cd formation_git
\end{Verbatim}
\end{beamercolorbox}

Configuration de l'identité de l'utilisateur :
\begin{itemize}
\item Permet d'identifier l'auteur des mises à jour \\
\item \verb+global+ : configuration au niveau du système \\
\item \verb+local+ : configuration au niveau du répertoire courant
\end{itemize}

\begin{beamercolorbox}[rounded=true,shadow=true]{terminal}
\vspace{-\seplength}
\begin{Verbatim}
$ git config --global/local user.name "<prénom nom>"
$ git config --global/local user.email "<adresse email>"
\end{Verbatim}
\end{beamercolorbox}

Initialisation du repo git :
\begin{beamercolorbox}[rounded=true,shadow=true]{terminal}
\vspace{-\seplength}
\begin{Verbatim}
$ git init
Dépôt Git vide initialisé dans /home/user/project/.git/
\end{Verbatim}
\end{beamercolorbox}

\end{frame}

\subsection{\'Etat du répertoire local}

\begin{frame}[fragile]{Voir l'état du répertoire local}
	\begin{block}{La commande}
		\verb+$ git status+
	\end{block}
	\begin{block}{Utilité}
		Permet de connaître à tout moment l'état d'un répertoire git :
		\begin{itemize}
			\item La branche sur laquelle on se situe
			\item La divergence avec un repo distant
			\item Les fichiers suivis ou non suivis
			\item Les fichiers modifiés depuis la dernière validation
			\item Les fichiers qui seront validés et ceux qui ne le seront pas.
		\end{itemize}
	\end{block}
	\begin{block}{En résumé}
		{\bf Le Saint Graal des commandes git !}
	\end{block}
\end{frame}

\begin{frame}[fragile]{\texttt{git status} à la loupe}
	Pour le moment...

	\begin{beamercolorbox}[rounded=true,shadow=true]{terminal}
\vspace{-\seplength}
\begin{Verbatim}
$ git status
Sur la branche master

Aucun commit

rien à valider (créez/copiez des fichiers et utilisez "git add" pour les suivre)
\end{Verbatim}
	\end{beamercolorbox}

	On va créer un fichier !

	\begin{beamercolorbox}[rounded=true,shadow=true]{terminal}
\vspace{-\seplength}
\begin{Verbatim}
$ echo "J'apprends à utiliser git" > formation.txt
\end{Verbatim}
\Pause
\vspace{-\seplength}
\begin{Verbatim}
$ git status
Sur la branche master

Aucun commit

Fichiers non suivis:
  (utilisez "git add <fichier>..." pour inclure dans ce qui sera validé)

	\textcolor{red}{formation.txt}

aucune modification ajoutée à la validation mais des fichiers non suivis sont présents
(utilisez "git add" pour les suivre)

\end{Verbatim}
\end{beamercolorbox}

\end{frame}

\subsection{Ajouter une version}

\begin{frame}{Un commit, c'est quoi ?}

Pour faire court :
\begin{itemize}
\item Commit = Validation
\item Point de sauvegarde
\item Ensemble de \textbf{modifications} depuis le dernier commit
\end{itemize}

\bigskip

\`A quoi ça sert ?
\begin{itemize}
\item Les commits se suivent
\item Sauvegarde incrémentale
\item Possibilité de revenir à une version donnée
\end{itemize}
\end{frame}

\begin{frame}{Working Directory vs. Staging Area vs. Repository}
	\begin{block}{Repository}
		Le Repository correspond aux fichiers dans l'état de la dernière validation connue par git.
	\end{block}

	\begin{block}{Working Directory}
		Le Working Directory correspond à l'état actuel du répertoire git :
		\begin{itemize}
			\item nouveaux fichiers pas encore ajoutés au Repository (fichiers non suivis)
			\item fichiers modifiés depuis la dernière version
		\end{itemize}
	\end{block}

	\begin{block}{Staging Area (ou Index)}
		Zone intermédiaire entre le Working Directory et le Repository.
		Elle contient les modifications apportées dans le Working Directory que git va ajouter au Repository.
	\end{block}

\end{frame}

\begin{frame}[fragile]{Ajouter des modifications pour validation}
	Ajouter les modifications d'un fichier pour validation : \\
	\verb+$ git add <fichier(s)>+

	\medskip

	Ajouter toutes les modifications pour validation (tous les fichiers) : \\
	\verb+$ git add -A+

	\medskip

	Enlever les modifications d'un fichier de la validation : \\
	\verb+$ git reset <fichier>+ \\
	{\it (ne change pas le contenu du fichier mais indique juste à git d'ignorer ses modifications pour la validation)}

	% faire une jolie image avec un rond Working Directory et Staging Area avec une flèche dans un sens "git add" et une flèche "git reset"
\end{frame}

\begin{frame}[fragile]
\begin{beamercolorbox}[rounded=true,shadow=true]{terminal}
\vspace{-\seplength}
\begin{Verbatim}
$ git status
Sur la branche master
Aucun commit
Fichiers non suivis:

	\textcolor{red}{formation.txt}
\end{Verbatim}
\Pause
\vspace{-\seplength}
\begin{Verbatim}
$ git add formation.txt
\end{Verbatim}
\Pause
\vspace{-\seplength}
\begin{Verbatim}
$ git status
Sur la branche master

Aucun commit

Modifications qui seront validées :
  (utilisez "git rm --cached <fichier>..." pour désindexer)

	\textcolor{green}{nouveau fichier : formation.txt}
\end{Verbatim}
\Pause
\vspace{-\seplength}
\begin{Verbatim}
$ git reset formation.txt
\end{Verbatim}
\Pause
\vspace{-\seplength}
\begin{Verbatim}
$ git status
Sur la branche master
Aucun commit
Fichiers non suivis:

	\textcolor{red}{formation.txt}

$ git add formation.txt
\end{Verbatim}
\end{beamercolorbox}
\end{frame}

\begin{frame}[fragile]{Valider les modifications}

Valider les changements qui ont été ajoutés au staging area :\\
\verb+$ git commit+.

\medskip

Le commit doit contenir un message. Pour l'entrer directement : \\
\verb+$ git commit -m "<message>"+ \\

\bigskip

\begin{beamercolorbox}[rounded=true,shadow=true]{terminal}
\vspace{-\seplength}
\begin{Verbatim}
$ git commit -m "Ajout du premier fichier"
[master (commit racine) 6b6799b] Ajout du premier fichier
 1 file changed, 1 insertion(+)
 create mode 100644 formation.txt
\end{Verbatim}
\end{beamercolorbox}


\end{frame}

\begin{frame}{Dissection d'un commit}
	\begin{block}{À propos du commit}
		\begin{itemize}
			\item Chaque commit possède un identifiant unique;
			\item Un commit est asocié à une unique personne;
			\item L'historique des commits est incrémental. Tout commit (excepté le premier) a un commit "père"
			\item Un commit correspond à une version figée du projet;
		\end{itemize}
	\end{block}
\end{frame}

\subsection{Voir l'historique}

\begin{frame}[fragile]{git log}
	Afficher l'historique des commits
	\begin{beamercolorbox}[rounded=true,shadow=true]{terminal}
		\vspace{-\seplength}
		\begin{Verbatim}
			$ git log
			\textcolor{yellow}{commit 2487fdd243542146f15a8e6bb00a94a39117ea1b (}{\bf \textcolor{cyan}{HEAD -> }\textcolor{green}{master}} \textcolor{yellow}{)}
			Author: huetremy <remy.huet@etu.utc.fr>
			Date:   Mon Sep 24 09:54:14 2018 +0200

    				Ajout du premier fichier
		\end{Verbatim}
	\end{beamercolorbox}
	\Pause
	On peut voir ici : \Pause
	\begin{itemize}
		\item L'identifiant unique du commit \Pause
		\item L'auteur (et son mail) \Pause
		\item La date du commit \Pause
		\item Le message qui a été mis lors du commit
	\end{itemize}
\end{frame}

\begin{frame}{git diff}
\end{frame}

\section{Concepts avancés}

\subsection{Le HEAD}

\begin{frame}{Le HEAD}
\end{frame}

\subsection{Enregistrer les modifications locales}

\begin{frame}{git stash}
\end{frame}

\subsection{Changer de version}

\begin{frame}{git checkout}
\end{frame}

\subsection{Annuler les modifications sur un fichier précis}

\begin{frame}{git checkout -- file}
\end{frame}

\section{Les remotes}

\subsection{Principe et application avec Gitlab}

\begin{frame}{Gitlab}
	Création d'un repo
\end{frame}

\subsection{Récupérer les ajouts distants}

\begin{frame}{git clone -- git pull}
	cloner le repo de la présentation (en HTTPS)
\end{frame}

\subsection{Envoyer des modifications}

\begin{frame}{git push}
	Sur repo perso
\end{frame}

\end{document}
